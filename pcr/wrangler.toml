#:schema node_modules/wrangler/config-schema.json
name = "pcr"
main = "src/index.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

# Durable Object for the CDP relay
[[durable_objects.bindings]]
name = "RELAY"
class_name = "RebrowRelay"

# Sandbox for executing Playwright code
# Binding must be named 'Sandbox' for proxyToSandbox to work
[[durable_objects.bindings]]
name = "Sandbox"
class_name = "Sandbox"

# Container image for Sandbox (local Dockerfile for wrangler dev)
[[containers]]
class_name = "Sandbox"
image = "./Dockerfile"
instance_type = "standard-2"

# Migrations for the Durable Objects
[[migrations]]
tag = "v1"
new_classes = ["RebrowRelay"]
new_sqlite_classes = ["Sandbox"]

[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = true

[observability.traces]
enabled = false
persist = true
head_sampling_rate = 1
